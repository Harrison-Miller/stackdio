{% load staticfiles %}
<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title>stackd.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="{% static 'css/theme/jquery-ui-1.10.3.custom.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/bootstrap-select.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/stackdio.css' %}" rel="stylesheet">
</head>

<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="navbar-inner">
            <div class="container-fluid">
                <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="brand" href="#">stackd.io [ <small class="text-warning">if you got a problem, yo, I'll solve it</small class="muted"> ]</a>
                <div class="nav-collapse collapse">
                    <ul class="nav">
                        <li class="active"><a href="#">home</a></li>
                        <li><a href="http://github.com/stackdio/stackdio" target="_blank">source</a></li>
                        <li><a href="http://twitter.com/stackdio" target="_blank">@stackdio</a></li>
                    </ul>

                    <div class="btn-group pull-right">
                        <a class="btn btn-inverse btn-small" data-toggle="dropdown" href="#">
                            <span class="icon-white iconic-user"></span> {{ user.get_full_name }} <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="#" data-bind="click: showUserProfile">Profile</a></li>
                            <li><a href="#" data-bind="click: showPasswordForm">Change Password</a></li>
                            <li class="divider"></li>
                            <li><a href="{% url 'logout' %}">Logout</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 
        ======================================================================
        S I D E B A R
        ======================================================================
     -->
    <div id="sidebar">
        <ul class="nav nav-list" data-bind="foreach: sections">
            <li id="dashboard-href" class="navlink" data-bind="css: { active: $data == $root.currentSection() }, click: $root.gotoSection">
              <a href="#">
                <i class="icon-dashboard"></i>
                <span data-bind="text: $data"></span>
              </a>
            </li>
        </ul>
    </div>


    <!-- 
        ======================================================================
        M E S S A G E S
        ======================================================================
     -->
    <div class="view">
        <div id="alert-default-security-groups" class="alert hide alert-success">            
            <div><strong>Account created!</strong></div>
            <div style="padding:10px 0;">Do you want to define any default security groups that will be assigned to all hosts created under this account?</div>
            <button class="btn btn-inverted" data-bind="click: function () { $('#alert-default-security-groups').hide(); }">Non</button>
            <button class="btn btn-primary" data-bind="click: $root.securityGroup.setForAccount">Oui</button>
        </div>

        <div id="alert-error" class="alert hide alert-error">
            <button type="button" class="close" data-bind="click: closeError">&times;</button>
            <h4>Error!</h4>
            <div id="alert-error-details"></div>
        </div>

        <div id="alert-success" class="alert hide alert-success">
            <button type="button" class="close" data-bind="click: closeSuccess">&times;</button>
            <strong>Success!</strong> 
        </div>

        <div id="alert-no-profiles" class="alert hide alert-warning">
            <button type="button" class="close" data-bind="click: function () { $('#alert-no-profiles').hide(); }">&times;</button>
            <strong>Warning!</strong> You do not have any profiles created yet. Please create one now.
        </div>

        <div id="alert-no-accounts" class="alert hide alert-warning">
            <button type="button" class="close" data-bind="click: function () { $('#alert-no-accounts').hide(); }">&times;</button>
            <strong>Warning!</strong> You do not have any accounts created yet. Please create one now.
        </div>
    </div>


    <!-- 
        ======================================================================
        U S E R   P A S S W O R D
        ======================================================================
     -->
    <div id="user-password" title="Change Password" data-bind="" class="hide">
        <form id="user-password-form" class="form-horizontal">
        <div class="modal-body">
            <div class="control-group">
                <label class="control-label" style="width: 150px;" for="current_password">Current password</label>
                <div class="controls" style="margin-left: 160px">
                    <input id="current_password" type="password" class="input-block-level">
                </div>
            </div>

            <div class="control-group">
                <label class="control-label" style="width: 150px;" for="new_password">New password</label>
                <div class="controls" style="margin-left: 160px">
                    <input id="new_password" type="password" class="input-block-level">
                </div>
            </div>

            <div class="control-group">
                <label class="control-label" style="width: 150px;" for="new_password_confirm">Confirm password</label>
                <div class="controls" style="margin-left: 160px">
                    <input id="new_password_confirm" type="password" class="input-block-level">
                </div>
            </div>

            <div id="password-error" class="alert hide alert-error">
                <button type="button" class="close" data-bind="click: closeError">&times;</button>
            </div>

        </div>

        <div class="modal-footer">
            <button class="btn btn-primary" data-bind="click: $root.savePassword">Save</button>
            <button class="btn" data-bind="click: $root.closePasswordForm">Cancel</button>
        </div>
        </form>
    </div>


    <!-- 
        ======================================================================
        U S E R   P R O F I L E
        ======================================================================
     -->
    <div id="user-profile" title="Your Profile" data-bind="" class="hide">
        <form id="user-profile-form" class="form-horizontal">
        <div class="modal-body">
            <div class="control-group">
                <label class="control-label" style="width: 100px;" for="first_name">First name</label>
                <div class="controls" style="margin-left: 110px">
                    <input id="first_name" type="text" class="input-block-level" disabled placeholder="Aoibheann" value="{{ user.first_name }}">
                </div>
            </div>

            <div class="control-group">
                <label class="control-label" style="width: 100px;" for="last_name">Last name</label>
                <div class="controls" style="margin-left: 110px">
                    <input id="last_name" type="text" class="input-block-level" disabled placeholder="O'Shaughnessy" value="{{ user.last_name }}">
                </div>
            </div>

            <div class="control-group">
                <label class="control-label" style="width: 100px;" for="public_key">Public key</label>
                <div class="controls" style="margin-left: 110px">
                    <textarea id="public_key" class="input-block-level" rows="6"></textarea>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn btn-primary" data-bind="click: $root.saveProfile">Save</button>
            <button class="btn" data-bind="click: $root.closeProfileForm">Cancel</button>
        </div>
        </form>
    </div>


    <!-- 
        ======================================================================
        S T A C K   L I S T
        ======================================================================
     -->
    <div id="stacks-binding-target" data-bind='visible: $root.currentSection() === "Stacks"' class="hide">
        <div class="view">

            <div class="btn-group pull-right">
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                    New Stack <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" data-bind="foreach: stores.Accounts">
                    <li>
                        <a href="#" data-bind="text: title, click: $root.stack.showStackForm"></a>
                    </li>
                </ul>
            </div>

            <table id="stacks" class="table table-striped data-grid">
                <thead>
                    <tr>
                        <th style="width:20px">#</th>
                        <th style="width:20%">Title</th>
                        <th style="width:50%">Description</th>
                        <th style="width:20%">Status History</th>
                        <th style="width:50px"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.Stacks">
                    <tr>
                        <td data-bind="text: $data.id"></td>
                        <td><a href="#" data-bind="text: $data.title, click: $root.stack.showStackDetails"></a></td>
                        <td data-bind="text: $data.description"></td>
                        <td><a href='#' data-bind="bootstrapPopover : {content : $root.stack.popoverBuilder($data) }, text: 'View (' + $data.history.length + ') messages'"></a></td>
                        <td>
                            <div class="btn-group">
                                <a class="btn btn-info dropdown-toggle" data-toggle="dropdown" href="#">
                                    Action <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu" data-bind="foreach: $root.stack.stackActions">
                                    <li>
                                        <a href="#" data-bind="text:$data, click: function (data, event) { $root.stack.doStackAction(data, event, $parent) }"></a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>


        <!-- 
            ======================================================================
            N E W   S T A C K   F O R M
            ======================================================================
         -->
        <div id="stack-form-container" title="Stack Details">
            <div class="modal-body" style="min-height: 330px;">
                <div class="controls controls-row">
                    <input class="span5" id="stack_title" type="text" placeholder="Stack title">
                    <input class="span5" id="stack_purpose" type="text" placeholder="Purpose of stack">
                </div>

                <div>
                    <legend class="lead">Stack Hosts
                        <div class="btn-group pull-right">
                            <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                                Add Host <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu" data-bind="foreach: stores.Profiles">
                                <li>
                                    <a href="#" data-bind="text: title, click: $root.stack.showHostForm"></a>
                                </li>
                            </ul>
                        </div>
                    </legend>
                    <table id="stack_hosts" class="data-grid stretch-full">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Roles</th>
                                <th>Count</th>
                                <th>Size</th>
                                <th>Host Pattern</th>
                                <th>Security Groups</th>
                                <th style="width:50px;"></th>
                            </tr>
                        </thead>
                        <tbody data-bind="foreach: stores.NewHosts">
                            <tr>
                                <td data-bind="text: id"></td>
                                <td data-bind="html: flat_roles"></td>
                                <td data-bind="text: host_count"></td>
                                <td data-bind="text: size.title"></td>
                                <td data-bind="text: host_pattern"></td>
                                <td data-bind="html: flat_security_groups"></td>
                                <td><button type="button" class="btn-small btn-danger iconic-trash-stroke" data-bind="click: $root.stack.removeHost"></button></td>
                            </tr>     
                        </tbody>
                    </table>
                </div>

            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" data-bind="click: $root.stack.launchStack">Launch Stack</button>
                <button class="btn btn-info" data-bind="click: $root.stack.saveStack">Save Stack</button>
                <button class="btn" data-bind="click: $root.stack.closeStackForm">Close</button>
            </div>
        </div>


        <!-- 
            ======================================================================
            L A U N C H E D   H O S T   L I S T
            ======================================================================
         -->
        <div id="stack-details-container" title="Stack Hosts">
             <div class="modal-body">
                <table id="stack-details" class="data-grid">
                    <thead>
                        <tr>
                            <th style="width:25px">#</th>
                            <th style="width:20%">State</th>
                            <th style="width:40%">Host name</th>
                            <th style="width:30%">Created</th>
                            <th style="width:50px"></th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: stores.StackHosts">
                        <tr>
                            <td>
                                <a href='#' data-bind='click: $root.stack.showHostMetadata, text: id'></a>
                            </td>
                            <td data-bind="text: state"></td>
                            <td>
                                <a href='#' 
                                   target="_blank" 
                                   data-bind="text: hostname, attr: { href: 'http://'+fqdn, title: hostname }"></a>
                            </td>
                            <td data-bind="text: $root.moment(created).calendar()"></td>
                            <td>
                                <select id="host-action"
                                        data-width="125px"
                                        header="Perform action"
                                        title="Perform action"
                                        class="dropup" 
                                        data-container="body"
                                        data-bind="options: $root.stack.stackHostActions, 
                                                   optionsValue: $data,
                                                   optionsText: $data,
                                                   click: function (data, event) { $root.stack.doStackHostAction(data, event, $parent) }"
                                ></select>
    <!-- 
                                <div class="btn-group">
                                    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
                                        Action <span class="caret"></span>
                                    </a>
                                    <ul class="dropdown-menu" data-bind="foreach: $root.stack.stackHostActions">
                                        <li>
                                            <a href="#" 
                                               data-bind="text:$data, 
                                                          click: function (data, event) { 
                                                             $root.stack.doStackHostAction(data, event, $parent) 
                                                           }"></a>
                                        </li>
                                    </ul>
                                </div>
     -->
                            </td>
                        </tr>     
                    </tbody>
                </table>
            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" data-bind="click: $root.stack.closeStackHosts">Close</button>
            </div>
        </div>

        <!-- 
            ======================================================================
            H O S T   M E T A D A T A
            ======================================================================
         -->
        <div id="host-metadata-container" title="Host Metadata">
             <div class="small-modal-body">
                <table id="host-metadata" class="data-grid">
                    <thead>
                        <tr>
                            <th style="width:50%">Metadata</th>
                            <th style="width:50%">Value</th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: stores.HostMetadata">
                        <tr>
                            <td data-bind="text: key"></td>
                            <td data-bind="text: value"></td>
                        </tr>     
                    </tbody>
                </table>
            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" data-bind="click: $root.stack.closeHostMetadata">Close</button>
            </div>
        </div>

            

        <!-- 
            ======================================================================
            N E W   H O S T   F O R M
            ======================================================================
         -->
        <div id="host-form-container" title="Host Details">
           <form id="host-form" class="form-horizontal">
                <div class="modal-body">
                    <div class="control-group">
                        <label class="control-label" for="host_count">Count</label>
                        <div class="controls">
                            <input type="text" id="host_count" class="input-mini" placeholder="">
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="host_instance_size">Instance size</label>
                        <div class="controls">
                            <select id="host_instance_size" 
                                    data-bind="options: stores.InstanceSizes, 
                                               optionsValue: 'id',
                                               optionsText: 'title',
                                               optionsCaption: 'Choose size...'"
                                    data-size="12"
                                    data-container="body"
                                    class="input-xlarge "></select>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="availability_zone">Availability zone</label>
                        <div class="controls">
                            <select id="availability_zone" 
                                    data-bind="options: stores.Zones, 
                                               optionsValue: 'id',
                                               optionsText: 'title',
                                               optionsCaption: 'Choose a zone...'"
                                    data-container="body"
                                    class="input-xlarge "></select>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="host_security_groups">Security groups</label>
                        <div class="controls">
                            <select id="host_security_groups" 
                                    multiple
                                    data-selected-text-format="count"
                                    data-bind="options: stores.AccountSecurityGroups, 
                                               optionsValue: 'id', 
                                               optionsText: 'name'",
                                    data-container="body"
                                    data-header="Choose security groups"
                                    class="input-xlarge"></select> 
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="host_hostname">Host pattern</label>
                        <div class="controls">
                            <input type="text" id="host_hostname" class="input-xlarge" placeholder="{name}.yourdomain.com">
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="host_roles">SLS</label>
                        <div class="controls">
                            <select id="host_roles" 
                                    multiple
                                    data-selected-text-format="count"
                                    data-bind="options: stores.Roles, 
                                               optionsValue: 'id', 
                                               optionsText: 'title'",
                                    data-container="body"
                                    data-header="Choose states to install"
                                    class="input-xlarge"></select>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for="host_volumes">
                            Volumes
                        </label>
                        <div class="controls">
                            <table id="host_volumes" class="data-grid">
                                <thead>
                                    <tr>
                                        <th>Snapshot</th>
                                        <th>Mount point</th>
                                        <th style="width:50px;"></th>
                                    </tr>
                                </thead>
                                <tbody data-bind="foreach: stores.HostVolumes">
                                    <tr>
                                        <td data-bind="text: snapshot.title"></td>
                                        <td data-bind="text: mount_point"></td>
                                        <td><button type="button" class="btn-small btn-danger iconic-trash-stroke" data-bind="click: $root.volume.removeHostVolume"></button></td>
                                    </tr>     
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="row">
                        <div class="control-group">
                            <label class="control-label" for="spot_instance"></label>
                            <div class="controls">
                                <input type="checkbox" id="spot_instance"> Request spot instances
                            </div>
                        </div>

                        <div class="control-group" data-bind="visible: stack.isSpotInstance">
                            <label class="control-label" for="spot_instance_price"></label>
                            <div class="controls">
                                <input type="text" id="spot_instance_price" class="input-medium" placeholder="Bid price for instances">
                            </div>
                        </div>
                    </div>
                </div>  
        
                <div class="modal-footer">
                    <button class="btn btn-info" data-bind="click: $root.volume.showVolumeForm">Add Volume</button>
                    <button class="btn btn-primary" data-bind="click: $root.stack.addHost">Save Host</button>
                    <button class="btn" data-bind="click: $root.stack.closeHostForm">Close</button>
                </div>
            </form>
        </div>

        <!-- 
            ======================================================================
            N E W   V O L U M E   F O R M
            ======================================================================
         -->
        <div id="volume-form-container" title="Volume Details">
            <form id="host-volume-form" class="form-horizontal">
            <div class="modal-body">
                <div class="control-group">
                    <label class="control-label" for="volume_snapshot">Snapshot</label>
                    <div class="controls">
                        <select id="volume_snapshot" data-bind="options: stores.Snapshots, optionsValue: 'id', optionsText: 'title'"></select>
                    </div>
                </div>


                <div class="control-group">
                    <label class="control-label" for="volume_device">Device</label>
                    <div class="controls">
                        <input id="volume_device" type="text" class="input-block-level" placeholder="Device name">
                    </div>
                </div>


                <div class="control-group">
                    <label class="control-label" for="volume_mount_point">Mount point</label>
                    <div class="controls">
                        <input type="text" id="volume_mount_point" class="input-block-level" placeholder="/mnt/x">
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" data-bind="click: $root.volume.addHostVolume">Save Volume</button>
                <button class="btn" data-bind="click: $root.volume.closeVolumeForm">Close</button>
            </div>
            </form>
        </div>

    </div>



    <!-- 
        ======================================================================
        S N A P S H O T   L I S T
        ======================================================================
     -->
    <div id="snapshots-binding-target" class="hide" data-bind='visible: $root.currentSection() === "Snapshots"'>
        <div class="view">
            <div class="btn-group pull-right">
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                    New Snapshot <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" data-bind="foreach: stores.Accounts">
                    <li>
                        <a href="#" data-bind="text: title, click: $root.snapshot.showSnapshotForm"></a>
                    </li>
                </ul>
            </div>

            <table id="snapshots" class="table table-striped data-grid">
                <thead>
                    <tr>
                        <th style="width:20px">#</th>
                        <th style="width:20%">Title</th>
                        <th style="width:25%">Description</th>
                        <th style="width:10%">ID</th>
                        <th style="width:10%">Size (GB)</th>
                        <th style="width:20%">Account</th>
                        <th style="width:5%"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.Snapshots">
                    <tr>
                        <td data-bind="text: id"></td>
                        <td data-bind="text: title"></td>
                        <td data-bind="text: description"></td>
                        <td data-bind="text: snapshot_id"></td>
                        <td data-bind="text: size_in_gb"></td>
                        <td data-bind="text: account.title"></td>
                        <td>
                            <button type="button" 
                                    class="btn-small btn-danger iconic-trash-stroke"
                                    data-bind="visible: $root.account.userCanModify,click: $root.account.removeSnapshot"></button>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

        <!-- 
            ======================================================================
            S N A P S H O T   F O R M
            ======================================================================
         -->
        <div id="snapshot-form-container" title="Snapshot Details" class="stackd-form form-small">
            <form id="snapshot-form">
            <div class="modal-body">
                <div class="span2">Title</div>
                <div class="span4 no-margin">
                    <input id="snapshot_title" type="text" class="input-block-level" placeholder="">
                </div>

                <div class="span2">Description</div>
                <div class="span4 no-margin">
                    <input id="snapshot_description" type="text" class="input-block-level" placeholder="">
                </div>

                <div class="span2">Snapshot ID</div>
                <div class="span4 no-margin">
                    <input id="snapshot_id" type="text" class="input-block-level" placeholder="EC2 snapshot ID">
                </div>

                <div class="span2">Size</div>
                <div class="span4 no-margin">
                    <input id="snapshot_size" type="text" class="input-block-level" placeholder="in GB">
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn" data-bind="click: $root.snapshot.closeSnapshotForm">Close</button>
                <button class="btn btn-primary" data-bind="click: $root.snapshot.addSnapshot">Save</button>
            </div>
            </form>
        </div>
    </div>



    <!-- 
        ======================================================================
        A C C O U N T   L I S T
        ======================================================================
     -->
    <div id="accounts-binding-target" class="hide" data-bind='visible: $root.currentSection() == "Accounts"'>
        <div class="view">
            <div class="btn-group pull-right" data-bind="visible: isSuperUser">
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                    New Account
                    <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" data-bind="foreach: stores.ProviderTypes">
                    <li>
                        <a href="#" data-bind="text: title, click: $root.account.showAccountForm"></a>
                    </li>
                </ul>
            </div>

            <table id="accounts" class="table table-striped data-grid">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Title</th>
                        <th>Description</th>
                        <th style="width:5%"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.Accounts">
                    <tr>
                        <td data-bind="text: id"></td>
                        <td data-bind="text: title"></td>
                        <td data-bind="text: description"></td>
                        <td>
                            <div class="btn-group" data-bind="visible: $root.isSuperUser">
                                <a class="btn btn-info dropdown-toggle" data-toggle="dropdown" href="#">
                                    Action <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="#" data-bind="text:'Delete', click: $root.account.deleteAccount"></a>
                                    </li>
                                    <li>
                                        <a href="#" data-bind="text:'Edit Security Groups', click: $root.securityGroup.setForAccount"></a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

        <!-- 
            ======================================================================
            A C C O U N T   F O R M
            ======================================================================
        -->
        <div id="accounts-form-container" title="New Provider Account Details" class="stackd-form form-small">
            <form id="account-form">
                <div class="modal-body large-modal-body">
                    <div class="span2">Title</div>
                    <div class="span4 no-margin">
                        <input id="title" type="text" class="input-block-level" placeholder="">
                    </div>

                    <div class="span2">Description</div>
                    <div class="span4 no-margin">
                        <input id="description" type="text" class="input-block-level" placeholder="">
                    </div>

                    <div class="span2">AWS Access Key</div>
                    <div class="span4 no-margin">
                        <input id="access_key_id" type="text" class="input-block-level" placeholder="">
                    </div>

                    <div class="span2">AWS Secret Key</div>
                    <div class="span4 no-margin">
                        <input id="secret_access_key" type="text" class="input-block-level" placeholder="">
                    </div>

                    <div class="span2">AWS Keypair Name</div>
                    <div class="span4 no-margin">
                        <input id="keypair" type="text" class="input-block-level" placeholder="">
                    </div>

                    <div class="span2">Default Zone</div>
                    <div class="span4 no-margin">
                        <select id="default_availability_zone" 
                            data-bind="options: stores.Zones, optionsText: 'title', optionsValue: 'id', optionsCaption: 'Choose default zone...'" 
                            data-container="body"
                            class="stretch-full"></select>
                    </div>

                    <div class="span2">Route 53 Domain</div>
                    <div class="span4 no-margin">
                        <input id="route53_domain" type="text" class="input-block-level" placeholder="e.g. dev.synthesyscloud.com">
                    </div>

                    <div class="span2">Private Key File</div>
                    <div class="span4 no-margin">
                        <input id="private_key_file" type="file" class="input-block-level" placeholder="">
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn" data-bind="click: $root.account.closeAccountForm">Close</button>
                    <button class="btn btn-primary" data-bind="click: $root.account.addAccount">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 
        ======================================================================
        P R O F I L E   L I S T
        ======================================================================
    -->
    <div id="profile-binding-target" class="hide" data-bind='visible: currentSection() === "Profiles"'>
        <div class="view">
            <div class="btn-group pull-right" data-bind="visible: $root.isSuperUser">
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                    New Profile
                    <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" data-bind="foreach: stores.Accounts">
                    <li>
                        <a href="#" data-bind="text: title, click: $root.profile.showProfileForm"></a>
                    </li>
                </ul>
            </div>

            <table id="profiles" class="table table-striped data-grid">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Title</th>
                        <th>Description</th>
                        <th>ID</th>
                        <th style="width:5%"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.Profiles">
                    <tr>
                        <td data-bind="text: id"></td>
                        <td data-bind="text: title"></td>
                        <td data-bind="text: description"></td>
                        <td data-bind="text: typeof image_id === 'object' ? 'n/a' : image_id"></td>
                        <td>
                            <button type="button" 
                                    class="btn-small btn-danger iconic-trash-stroke"
                                    data-bind="visible: $root.isSuperUser,
                                               click: $root.profile.deleteProfile"
                            ></button>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

        <!-- 
            ======================================================================
            P R O F I L E   F O R M
            ======================================================================
        -->
        <div id="profile-form-container" title="New Profile Details" class="stackd-form form-small">
            <form id="profile-form">
            <div class="modal-body">
                <div class="span2">Title</div>
                <div class="span4 no-margin">
                    <input id="profile_title" type="text" class="input-block-level" placeholder="">
                </div>

                <div class="span2">Description</div>
                <div class="span4 no-margin">
                    <input id="profile_description" type="text" class="input-block-level" placeholder="">
                </div>

                <div class="span2">AMI</div>
                <div class="span4 no-margin">
                    <input id="image_id" type="text" class="input-block-level" placeholder="">
                </div>

                <div class="span2">Default Instance Size</div>
                <div class="span4 no-margin">
                    <select id="default_instance_size" 
                        data-bind="options: stores.InstanceSizes, optionsText: 'title', optionsValue: 'id', optionsCaption: 'Choose...'" 
                        data-size="8"
                        data-container="body"
                        class="stretch-full"></select>
                </div>

                <div class="span2">SSH User</div>
                <div class="span4 no-margin">
                    <input id="ssh_user" type="text" class="input-block-level" placeholder="">
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn" data-bind="click: $root.profile.closeProfileForm">Close</button>
                <button class="btn btn-primary" data-bind="click: $root.profile.addProfile">Save</button>
            </div>
            </form>
        </div>
    </div>

    <!-- 
        ======================================================================
        S E C U R I T Y   G R O U P   L I S T
        ======================================================================
    -->
    <div id="security-group-container" class="hide" data-bind='visible: currentSection() === "Security"'>
        <div class="view">
            <div class="btn-group pull-right">
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                    New Security Group
                    <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" data-bind="foreach: stores.Accounts">
                    <li>
                        <a href="#" data-bind="text: title, click: $root.securityGroup.showSecurityGroupForm"></a>
                    </li>
                </ul>
            </div>

            <table id="security_group_list" class="table table-striped data-grid">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Title</th>
                        <th>Description</th>
                        <th>Account</th>
                        <th style="width:5%"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.SecurityGroups">
                    <tr>
                        <td data-bind="text: id"></td>
                        <td data-bind="text: name"></td>
                        <td data-bind="text: description"></td>
                        <td data-bind="text: account.title"></td>
                        <td>
                            <div class="btn-group" data-bind="visible: $root.isSuperUser">
                                <a class="btn btn-info btn-small dropdown-toggle" data-toggle="dropdown" href="#">
                                    Action <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="#" data-bind="text:'Delete', click: $root.securityGroup.deleteSecurityGroup"></a>
                                    </li>
                                    <li>
                                        <a href="#" data-bind="text:'Define Rules', click: $root.securityGroup.editGroupRules"></a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

        <!-- 
            ======================================================================
            S E C U R I T Y   G R O U P   F O R M
            ======================================================================
        -->
        <div id="securitygroup-form-container" title="New Security Group" class="stackd-form form-small">
            <form id="securitygroup-form" class="form-horizontal">
                <div class="modal-body">
                    <div class="control-group">
                        <label class="control-label" style="width: 40px;" for="securitygroup_name">Title</label>
                        <div class="controls" style="margin-left: 60px">
                            <input id="securitygroup_name" type="text" class="input-block-level">
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn" data-bind="click: $root.securityGroup.closeSecurityGroupForm">Close</button>
                    <button class="btn btn-primary" data-bind="click: function (data, event) { 
                                        securityGroup.addSecurityGroup($('#securitygroup_name').val(), event); 
                                    }">Save</button>
                </div>
            </form>
        </div>

        <!-- 
            ======================================================================
            S E C U R I T Y   G R O U P   R U L E S   L I S T   D I A L O G
            ======================================================================
        -->
        <div id="securitygroup-rules-form-container" title="Security Group Rules" class="stackd-form">
            <div class="modal-body">
                <table id="security_group_rules_list" class="table table-striped data-grid">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>From</th>
                            <th>To</th>
                            <th>Protocol</th>
                            <th style="width:5%"></th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: stores.SecurityGroupRules">
                        <tr>
                            <td data-bind="text: (rule.split(':').length === 1) ? rule : rule.split(':')[1]"></td>
                            <td data-bind="text: from_port"></td>
                            <td data-bind="text: to_port"></td>
                            <td data-bind="text: protocol"></td>
                            <td>
                                <button type="button" 
                                        class="btn-small btn-danger iconic-trash-stroke"
                                        data-bind="click: $root.securityGroup.deleteGroupRule"
                                ></button>
                            </td>
                        </tr>     
                    </tbody>
                </table>
            </div>

            <div class="modal-footer">
                <button class="btn" data-bind="click: $root.securityGroup.closeRulesForm">Close</button>
                <button class="btn btn-success iconic-plus" data-bind="click: function () { 
                                    $('#new-rule-dialog').dialog('open');
                                }"> Add</button>
            </div>
        </div>

        <!-- 
            ======================================================================
            N E W   S E C U R I T Y   G R O U P   R U L E   D I A L O G
            ======================================================================
        -->
        <div id="new-rule-dialog" title="New Access Rule" class="stackd-form">
            <form id="group-rule-form" class="form-horizontal">
                <div class="modal-body">

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="rule_protocol">Protocol</label>
                        <div class="controls" style="margin-left: 160px">
                            <select id="rule_protocol" 
                                    data-bind="options: ['tcp','udp','icmp']",
                                    data-container="body"
                                    class="input-xlarge"></select> 
                        </div>
                    </div>


                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="rule_from_port">From port</label>
                        <div class="controls" style="margin-left: 160px">
                            <input id="rule_from_port"type="text"class="input-xlarge" placeholder="22">
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="rule_to_port">To port</label>
                        <div class="controls" style="margin-left: 160px">
                            <input id="rule_to_port"type="text"class="input-xlarge" placeholder="22">
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="rule_ip_address">IP address</label>
                        <div class="controls" style="margin-left: 160px">
                            <input id="rule_ip_address"type="text"class="input-xlarge" placeholder="0.0.0.0/32">
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn" data-bind="click: function () { $('#new-rule-dialog').dialog('close') }">Cancel</button>
                    <button class="btn btn-primary" data-bind="click: securityGroup.addRule"> Save</button>
                </div>
            </form>
        </div>

        <!-- 
            ======================================================================
            D E F A U L T   S E C U R I T Y   G R O U P   F O R M
            ======================================================================
        -->
        <div id="default-securitygroup-form-container" title="Default Security Groups" class="stackd-form form-small">
            <form id="default-securitygroup-form" class="form-horizontal">
                <div class="modal-body large-modal-body">

                    <div class="control-group">
                        <div class="lead">Option 1. Use an existing group</div>
                        If you previously imported AWS groups, or created your own through stackd.io, you can select one of 
                        those groups that are listed here.
                    </div>

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="stackdio_security_group">Your stackd.io groups</label>
                        <div class="controls" style="margin-left: 160px">
                            <select id="stackdio_security_group" 
                                    data-selected-text-format="count"
                                    data-bind="options: stores.AccountSecurityGroups, 
                                               optionsValue: 'id', 
                                               optionsText: 'name'",
                                    data-container="body"
                                    class="input-xlarge"></select> 
                            <button class="btn btn-success iconic-plus" 
                                    data-bind="click: function (data, event) { 
                                        securityGroup.addDefaultSecurityGroup($('#stackdio_security_group option:selected').text(), event); 
                                    }"> Add</button>

                        </div>
                    </div>

                    <div class="control-group">
                        <div class="lead">Option 2. Create new group</div>
                        If you would like to create a new security group that does not already exist in stackd.io, 
                        simply type in the name for the group here and it will created. If there are existing AWS
                        groups that match what you are entering, you will see suggestions.
                    </div>

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="new_securitygroup_name">Create new group</label>
                        <div class="controls" style="margin-left: 160px">
                            <input id="new_securitygroup_name" 
                                   type="text"
                                   class="input-xlarge"
                                   data-bind="event: { keypress: securityGroup.capture }"> 
                            <button class="btn btn-success iconic-plus" 
                                    data-bind="click: function (data, event) { 
                                        securityGroup.addDefaultSecurityGroup(document.getElementById('new_securitygroup_name').value, event); 
                                    }"> Add</button>
                        </div>
                    </div>

                    <div class="control-group">
                        <div class="lead">Assigned Default Groups</div>
                        <div>To remove any default security groups assigned to this account, click on the 'x' in the label below.</div>
                        <div style="margin: 10px 0 0 0;" id="default_group_list"></div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn" data-bind="click: $('#default-securitygroup-form-container').dialog('close')">Cancel</button>
                    <button class="btn btn-primary iconic-check" data-bind="click: $('#default-securitygroup-form-container').dialog('close')"> Done</button>
                </div>
            </form>
        </div>
    </div>

    <script data-main="{% static 'js/app' %}" src="{% static 'js/require.js' %}"></script>
    <script>
    window.stackdio_user = {};
    window.stackdio_user.su = "{{ user.is_superuser }}";
    </script>


<!--
    <script src="{% static 'js/require.js' %}"></script>
        <script>
            /*
             * 
             *  WHEN READY TO TRY A PRODUCTION BUILD, FOLLOW THESE INSTRUCTIONS
             *
             *      1. Ensure you have node.js installed on your system.
             *      2. npm install -g requirejs
             *      3. cd /{stackdio_root_dir}/core/static
             *      4. node r.js -o build.js
             *      5. Then uncomment this block of code, and comments out the <script> tag above.
             *
             */
            require.config({
                paths: {
                    //Comment out this line to go back to loading
                    //the non-optimized main.js source file.
                    "app": "{% static 'stackdio-built' %}"
                }
            });
            require(["app"]);
        </script>
-->

</body>
</html>
