<!DOCTYPE HTML>
<html>
<head>
    <meta charset="UTF-8">
    <title>stackd.io</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="/static/css/theme/jquery-ui-1.10.3.custom.min.css" rel="stylesheet">
    <link href="/static/stackdio/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/stackdio/bower_components/bootstrap-select/bootstrap-select.min.css" rel="stylesheet">
    <link href="/static/css/stackdio.css" rel="stylesheet">
</head>

<body>

    <!-- 
        ======================================================================
         N A V I G A T I O N
        ======================================================================
     -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" style="padding: 5px 15px 5px 15px;" href="#">
                <img src="/static/img/logo.png" style="height: 33px"> stackd.io
            </a>
        </div>

        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li class="active"><a href="#">home</a></li>
                <li><a href="http://github.com/stackdio/stackdio" target="_blank">source</a></li>
                <li><a href="http://twitter.com/stackdio" target="_blank">@stackdio</a></li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <div class="btn-group">
                        <button type="button" class="btn btn-inverse navbar-btn dropdown-toggle" data-toggle="dropdown">
                            <span class="glyphicon glyphicon-user"></span>
                            Your Account
                            <span class="caret"></span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li><a href="#" data-bind="click: showUserProfile">User Profile</a></li>
                            <li><a href="#" data-bind="click: showPasswordForm">Change Password</a></li>
                            <li class="divider"></li>
                            <li><a href="#" data-bind="click: gotoSection('Accounts')">Your Cloud Accounts</a></li>
                            <li class="divider"></li>
                            <li><a href="/logout">Logout</a></li>
                        </ul>
                    </div>
                </li>
                <li>
                    <p class="navbar-text"> </p>
                </li>
            </ul>
        </div>
    </nav>

    <!-- 
        ======================================================================
        S I D E B A R
        ======================================================================
     -->
    <div id="sidebar">
        <ul class="nav nav-list" data-bind="foreach: sections">
            <li id="dashboard-href" class="navlink" data-bind="click: $root.gotoSection">
              <a href="#" data-bind="css: { active: $data == $root.currentSection() }">
                <i class="icon-dashboard"></i>
                <span data-bind="text: $data"></span>
              </a>
            </li>
        </ul>
    </div>


    <!-- 
        ======================================================================
        M E S S A G E S
        ======================================================================
     -->
    <div class="view">
        <div id="alert-default-security-groups" class="alert hide alert-success">            
            <div><strong>Account created!</strong></div>
            <div style="padding:10px 0;">Do you want to define any default security groups that will be assigned to all hosts created under this account?</div>
            <button class="btn btn-inverted" data-bind="click: function () { $('#alert-default-security-groups').hide(); }">Non</button>
            <button class="btn btn-primary" data-bind="click: $root.securityGroup.setForAccount">Oui</button>
        </div>

        <div id="alert-error" class="alert hide alert-error">
            <button type="button" class="close" data-bind="click: closeError">&times;</button>
            <h4>Error!</h4>
            <div id="alert-error-details"></div>
        </div>

        <div id="alert-success" class="alert hide alert-success">
            <button type="button" class="close" data-bind="click: closeSuccess">&times;</button>
            <strong>Success!</strong> 
        </div>

        <div id="alert-no-profiles" class="alert hide alert-warning">
            <button type="button" class="close" data-bind="click: function () { $('#alert-no-profiles').hide(); }">&times;</button>
            <strong>Warning!</strong> You do not have any profiles created yet. Please create one now.
        </div>

        <div id="alert-no-accounts" class="alert hide alert-warning">
            <button type="button" class="close" data-bind="click: function () { $('#alert-no-accounts').hide(); }">&times;</button>
            <strong>Warning!</strong> You do not have any accounts created yet. Please create one now.
        </div>
    </div>


    <!-- 
        ======================================================================
        U S E R   P A S S W O R D
        ======================================================================
     -->
    <div id="user-password" title="Change Password" class="hide" data-bind="">
        <form id="user-password-form" role="form" class="form-horizontal">
            <div class="modal-body">

                <div class="form-group">
                    <label for="current_password" class="col-sm-4 control-label">Current password</label>
                    <div class="col-sm-8">
                        <input type="password" class="form-control" id="current_password">
                    </div>
                </div>

                <div class="form-group">
                    <label for="new_password" class="col-sm-4 control-label">New password</label>
                    <div class="col-sm-8">
                        <input type="password" class="form-control" id="new_password">
                    </div>
                </div>

                <div class="form-group">
                    <label for="new_password_confirm" class="col-sm-4 control-label">Confirm</label>
                    <div class="col-sm-8">
                        <input type="password" class="form-control" id="new_password_confirm">
                    </div>
                </div>

                <div id="password-error" class="alert hide alert-error">
                    <button type="button" class="close" data-bind="click: closeError">&times;</button>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" data-bind="click: $root.savePassword">Save</button>
                <button class="btn" data-bind="click: $root.closePasswordForm">Cancel</button>
            </div>
        </form>
    </div>


    <!-- 
        ======================================================================
        U S E R   P R O F I L E
        ======================================================================
     -->
    <div id="user-profile" title="Your Profile" class="hide" data-bind="">
        <form id="user-profile-form" role="form" class="form-horizontal">
            <div class="modal-body">

                <div class="form-group">
                    <label for="first_name" class="col-sm-3 control-label">First name</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control disabled" id="first_name" value="{{ user.first_name }}" disabled>
                    </div>
                </div>

                <div class="form-group">
                    <label for="last_name" class="col-sm-3 control-label">Last name</label>
                    <div class="col-sm-9">
                        <input type="text" class="form-control" id="last_name" value="{{ user.last_name }}" disabled>
                    </div>
                </div>

                <div class="form-group">
                    <label for="public_key" class="col-sm-3 control-label">Public key</label>
                    <div class="col-sm-9">
                        <textarea id="public_key" class="form-control" rows="8"></textarea>
                    </div>
                </div>

            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" data-bind="click: $root.saveProfile">Save</button>
                <button class="btn" data-bind="click: $root.closeProfileForm">Cancel</button>
            </div>
        </form>
    </div>


    <!-- 
        ======================================================================
        B L U E P R I N T   L I S T
        ======================================================================
     -->
    <div id="blueprints-binding-target" data-bind='visible: $root.currentSection() === "Blueprints"' class="hide">
        <div class="view">

            <div class="row bottom-separation">
                <div class="col-xs-4 col-sm-4 col-md-4 large-heading">Blueprints</div>
                <div class="col-xs-4 col-sm-4 col-md-4 col-md-offset-4 col-sm-offset-4 col-xs-offset-4">
                    <div class="btn-group pull-right">
                        <button class="btn btn-primary" data-bind="click: $root.blueprint.showBlueprintForm">New Blueprint</button>
                    </div>
                </div>
            </div>

            <table id="stacks" class="table table-bordered">
                <thead>
                    <tr>
                        <th style="width:20%">Title</th>
                        <th style="width:50%">Description</th>
                        <th style="width:50px"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.Blueprints">
                    <tr>
                        <td><a href="#" data-bind="text: title"></a></td>
                        <td data-bind="text: description"></td>
                    </tr>     
                </tbody>
            </table>
        </div>
    </div>

    <!-- 
        ======================================================================
        B L U E P R I N T   F O R M
        ======================================================================
     -->
    <div id="blueprint-form-container" title="Blueprint Details"  data-bind="" class="stackd-form form-small hide">
        <form id="blueprint-form" role="form" class="form-inline">
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-5">
                        <label class="sr-only" for="blueprint_title">Title</label>
                        <input type="text" class="form-control" id="blueprint_title" placeholder="Blueprint title">
                    </div>
                    <div class="col-md-5">
                        <label class="sr-only" for="blueprint_purpose">Description</label>
                        <input type="text" class="form-control" id="blueprint_purpose" placeholder="Purpose of blueprint">
                    </div>
                </div>

                <div class="row top-separation">
                    <div class="col-xs-4 col-sm-4 col-md-4 small-heading">Blueprint Hosts</div>
                    <div class="col-xs-4 col-sm-4 col-md-4 col-md-offset-4 col-sm-offset-4 col-xs-offset-4">
                        <div class="btn-group pull-right">
                            <a class="btn btn-primary dropdown-toggle" style="color: #fff" data-toggle="dropdown" href="#">
                                Add Host <span class="caret"></span>
                            </a>
                            <ul class="dropdown-menu" data-bind="foreach: stores.Profiles">
                                <li>
                                    <a href="#" data-bind="text: title, click: $root.blueprint.showHostForm"></a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <table id="blueprint_hosts" class="table table-bordered">
                    <thead>
                        <tr>
                            <th>Roles</th><th>Count</th><th>Size</th><th>Host Pattern</th><th>Security Groups</th><th></th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: stores.NewHosts">
                        <tr>
                            <td data-bind="html: flat_roles"></td>
                            <td data-bind="text: host_count"></td>
                            <td data-bind="text: size.title"></td>
                            <td data-bind="text: host_pattern"></td>
                            <td data-bind="html: flat_security_groups"></td>
                            <td><button type="button" class="btn-small btn-danger glyphicon glyphicon-trash" data-bind="click: $root.blueprint.removeHost"></button></td>
                        </tr>     
                    </tbody>
                </table>
            </div>

            <div class="modal-footer">
                <button class="btn btn-info" data-bind="click: $root.blueprint.saveBlueprint">Save Stack</button>
                <button class="btn" data-bind="click: $root.blueprint.closeBlueprintForm">Close</button>
            </div>
        </form>
    </div>

    <!-- 
        ======================================================================
        N E W   H O S T   F O R M
        ======================================================================
     -->
    <div id="host-form-container" title="Host Details" data-bind="" class="hide">
        <form id="blueprint-host-form" role="form" class="form-horizontal">
            <div class="modal-body large-modal-body">

                <div class="form-group">
                    <label for="host_count" class="col-sm-4 control-label">Count</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="host_count" placeholder="">
                    </div>
                </div>

                <div class="form-group">
                    <label for="host_instance_size" class="col-sm-4 control-label">Instance size</label>
                    <div class="col-sm-8">
                        <select id="host_instance_size" 
                                data-bind="options: stores.InstanceSizes, 
                                           optionsValue: 'id',
                                           optionsText: 'title',
                                           optionsCaption: 'Choose size...'"
                                data-size="12"
                                data-container="body"
                                class="form-control"></select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="availability_zone" class="col-sm-4 control-label">Availability zone</label>
                    <div class="col-sm-8">
                        <select id="availability_zone" 
                                data-bind="options: stores.Zones, 
                                           optionsValue: 'id',
                                           optionsText: 'title',
                                           optionsCaption: 'Choose a zone...'"
                                data-container="body"
                                class="form-control"></select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="host_hostname" class="col-sm-4 control-label">Host pattern</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="host_hostname" placeholder="e.g. dn-{username}-{index}">
                    </div>
                </div>

                <div class="form-group">
                    <label for="host_volumes" class="col-sm-4 control-label">Volumes</label>
                    <div class="col-sm-8">
                        <table id="host_volumes" class="table table-bordered table-condensed" data-bind="visible: stores.HostVolumes.length > 0">
                            <thead>
                                <tr>
                                    <th>Snapshot</th>
                                    <th>Mount point</th>
                                    <th style="width:50px;"></th>
                                </tr>
                            </thead>
                            <tbody data-bind="foreach: stores.HostVolumes">
                                <tr>
                                    <td data-bind="text: snapshot.title"></td>
                                    <td data-bind="text: mount_point"></td>
                                    <td><button type="button" class="btn-small btn-danger iconic-trash-stroke" data-bind="click: $root.volume.removeHostVolume"></button></td>
                                </tr>     
                            </tbody>
                        </table>
                        <button class="btn btn-info btn-xs" data-bind="click: $root.volume.showVolumeForm">Add Volume</button>
                    </div>
                </div>

                <div class="form-group" data-bind="visible: stores.HostVolumes.length > 0">
                    <label for="spot_instance" class="col-sm-4 control-label"></label>
                    <div class="col-sm-8">
                        <input type="checkbox" id="spot_instance"> Request spot instances
                    </div>
                </div>

                <div class="form-group" data-bind="visible: stack.isSpotInstance">
                    <label for="spot_instance_price" class="col-sm-4 control-label"></label>
                    <div class="col-sm-8">
                        <input type="text" id="spot_instance_price" class="form-control" placeholder="Bid price for instances">
                    </div>
                </div>
            </div>  
    
            <div class="modal-footer">
                <button class="btn btn-primary" data-bind="click: $root.blueprint.addHost">Save Host</button>
                <button class="btn" data-bind="click: $root.blueprint.closeHostForm">Close</button>
            </div>
        </form>
    </div>

    <!-- 
        ======================================================================
        N E W   V O L U M E   F O R M
        ======================================================================
     -->
    <div id="volume-form-container" title="Volume Details" data-bind="" class="hide">
        <form id="host-volume-form" role="form" class="form-horizontal">
            <div class="modal-body large-modal-body">

                <div class="form-group">
                    <label for="volume_snapshot" class="col-sm-4 control-label">Snapshot</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="volume_snapshot" placeholder="">
                    </div>
                </div>

                <div class="form-group">
                    <label for="volume_device" class="col-sm-4 control-label">Device</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="volume_device" placeholder="">
                    </div>
                </div>

                <div class="form-group">
                    <label for="volume_mount_point" class="col-sm-4 control-label">Mount point</label>
                    <div class="col-sm-8">
                        <input type="text" class="form-control" id="volume_mount_point" placeholder="">
                    </div>
                </div>


                <label class="control-label" for="volume_snapshot">Snapshot</label>
                <div class="controls">
                    <select id="volume_snapshot" data-bind="options: stores.Snapshots, optionsValue: 'id', optionsText: 'title'"></select>
                </div>
            </div>


            <div class="control-group">
                <label class="control-label" for="volume_device">Device</label>
                <div class="controls">
                    <input id="volume_device" type="text" class="input-block-level" placeholder="Device name">
                </div>
            </div>


            <div class="control-group">
                <label class="control-label" for="volume_mount_point">Mount point</label>
                <div class="controls">
                    <input type="text" id="volume_mount_point" class="input-block-level" placeholder="/mnt/x">
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn btn-primary" data-bind="click: $root.volume.addHostVolume">Save Volume</button>
            <button class="btn" data-bind="click: $root.volume.closeVolumeForm">Close</button>
        </div>
        </form>
    </div>


    <!-- 
        ======================================================================
        S T A C K   L I S T
        ======================================================================
     -->
    <div id="stacks-binding-target" data-bind='visible: $root.currentSection() === "Stacks"' class="hide">
        <div class="view">

            <div class="btn-group pull-right bottom-separation">
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                    New Stack <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" data-bind="foreach: stores.Accounts">
                    <li>
                        <a href="#" data-bind="text: title, click: $root.stack.showStackForm"></a>
                    </li>
                </ul>
            </div>

            <table id="stacks" class="table table-bordered">
                <thead>
                    <tr>
                        <th style="width:20%">Title</th>
                        <th style="width:50%">Description</th>
                        <th style="width:20%">Status History</th>
                        <th style="width:50px"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.Stacks">
                    <tr>
                        <td><a href="#" data-bind="text: $data.title, click: $root.stack.showStackDetails"></a></td>
                        <td data-bind="text: $data.description"></td>
                        <td>
                            <a href='#' 
                               data-bind="bootstrapPopover: {
                                            content: $root.stack.popoverBuilder($data),
                                            title: 'Stack History'
                                          },
                                          text: 'View (' + $data.history.length + ') messages'"></a>
                        </td>
                        <td>
                            <div class="btn-group">
                                <a class="btn btn-info dropdown-toggle" data-toggle="dropdown" href="#">
                                    Action <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu" data-bind="foreach: $root.stack.stackActions">
                                    <li>
                                        <a href="#" data-bind="text:$data, click: function (data, event) { $root.stack.doStackAction(data, event, $parent) }"></a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>


        <!-- 
            ======================================================================
            L A U N C H E D   H O S T   L I S T
            ======================================================================
         -->
        <div id="stack-details-container" title="Stack Hosts">
             <div class="modal-body">
                <table id="stack-details" class="data-grid">
                    <thead>
                        <tr>
                            <th style="width:25px">#</th>
                            <th style="width:20%">State</th>
                            <th style="width:40%">Host name</th>
                            <th style="width:30%">Created</th>
                            <th style="width:50px"></th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: stores.StackHosts">
                        <tr>
                            <td>
                                <a href='#' data-bind='click: $root.stack.showHostMetadata, text: id'></a>
                            </td>
                            <td data-bind="text: state"></td>
                            <td>
                                <a href='#' 
                                   target="_blank" 
                                   data-bind="text: hostname, attr: { href: 'http://'+fqdn, title: hostname }"></a>
                            </td>
                            <td data-bind="text: $root.moment(created).calendar()"></td>
                            <td>
                                <select id="host-action"
                                        data-width="125px"
                                        header="Perform action"
                                        title="Perform action"
                                        class="dropup" 
                                        data-container="body"
                                        data-bind="options: $root.stack.stackHostActions, 
                                                   optionsValue: $data,
                                                   optionsText: $data,
                                                   click: function (data, event) { $root.stack.doStackHostAction(data, event, $parent) }"
                                ></select>
                            </td>
                        </tr>     
                    </tbody>
                </table>
            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" data-bind="click: $root.stack.closeStackHosts">Close</button>
            </div>
        </div>

        <!-- 
            ======================================================================
            H O S T   M E T A D A T A
            ======================================================================
         -->
        <div id="host-metadata-container" title="Host Metadata">
             <div class="small-modal-body">
                <table id="host-metadata" class="data-grid">
                    <thead>
                        <tr>
                            <th style="width:50%">Metadata</th>
                            <th style="width:50%">Value</th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: stores.HostMetadata">
                        <tr>
                            <td data-bind="text: key"></td>
                            <td data-bind="text: value"></td>
                        </tr>     
                    </tbody>
                </table>
            </div>

            <div class="modal-footer">
                <button class="btn btn-primary" data-bind="click: $root.stack.closeHostMetadata">Close</button>
            </div>
        </div>
    </div>



    <!-- 
        ======================================================================
        S N A P S H O T   L I S T
        ======================================================================
     -->
    <div id="snapshots-binding-target" class="hide" data-bind='visible: $root.currentSection() === "Snapshots"'>
        <div class="view">
            <div class="btn-group pull-right bottom-separation">
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                    New Snapshot <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" data-bind="foreach: stores.Accounts">
                    <li>
                        <a href="#" data-bind="text: title, click: $root.snapshot.showSnapshotForm"></a>
                    </li>
                </ul>
            </div>

            <table id="snapshots" class="table table-bordered">
                <thead>
                    <tr>
                        <th style="width:20%">Title</th>
                        <th style="width:25%">Description</th>
                        <th style="width:10%">ID</th>
                        <th style="width:10%">Size (GB)</th>
                        <th style="width:20%">Account</th>
                        <th style="width:5%"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.Snapshots">
                    <tr>
                        <td data-bind="text: title"></td>
                        <td data-bind="text: description"></td>
                        <td data-bind="text: snapshot_id"></td>
                        <td data-bind="text: size_in_gb"></td>
                        <td data-bind="text: account.title"></td>
                        <td>
                            <button type="button" 
                                    class="btn-small btn-danger iconic-trash-stroke"
                                    data-bind="visible: $root.isSuperUser, click: $root.account.removeSnapshot"></button>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

        <!-- 
            ======================================================================
            S N A P S H O T   F O R M
            ======================================================================
         -->
        <div id="snapshot-form-container" title="Snapshot Details" class="stackd-form form-small">
            <form id="snapshot-form">
            <div class="modal-body">
                <div class="span2">Title</div>
                <div class="span4 no-margin">
                    <input id="snapshot_title" type="text" class="input-block-level" placeholder="">
                </div>

                <div class="span2">Description</div>
                <div class="span4 no-margin">
                    <input id="snapshot_description" type="text" class="input-block-level" placeholder="">
                </div>

                <div class="span2">Snapshot ID</div>
                <div class="span4 no-margin">
                    <input id="snapshot_id" type="text" class="input-block-level" placeholder="EC2 snapshot ID">
                </div>

                <div class="span2">Size</div>
                <div class="span4 no-margin">
                    <input id="snapshot_size" type="text" class="input-block-level" placeholder="in GB">
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn" data-bind="click: $root.snapshot.closeSnapshotForm">Close</button>
                <button class="btn btn-primary" data-bind="click: $root.snapshot.addSnapshot">Save</button>
            </div>
            </form>
        </div>
    </div>



    <!-- 
        ======================================================================
        A C C O U N T   L I S T
        ======================================================================
     -->
    <div id="accounts-binding-target" class="hide" data-bind='visible: $root.currentSection() == "Accounts"'>
        <div class="view">
            <div class="row bottom-separation">
                <div class="col-xs-4 col-sm-4 col-md-4 large-heading">Accounts</div>
                <div class="col-xs-4 col-sm-4 col-md-4 col-md-offset-4 col-sm-offset-4 col-xs-offset-4">
                    <div class="btn-group pull-right bottom-separation" data-bind="visible: isSuperUser">
                        <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                            New Account
                            <span class="caret"></span>
                        </a>
                        <ul class="dropdown-menu" data-bind="foreach: stores.ProviderTypes">
                            <li>
                                <a href="#" data-bind="text: title, click: $root.account.showAccountForm"></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <table id="accounts" class="table table-bordered">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Description</th>
                        <th>Profiles</th>
                        <th style="width:5%"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.Accounts">
                    <tr>
                        <td data-bind="text: title"></td>
                        <td data-bind="text: description"></td>
                        <td>
                            <a data-bind="click: $root.profile.listProfiles, 
                                          text: $root.account.accountProfileLink(id)"></a>
                        </td>
                        <td>
                            <div class="btn-group" data-bind="visible: $root.isSuperUser">
                                <a class="btn btn-info dropdown-toggle btn-sm" data-toggle="dropdown" href="#">
                                    Action <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="#" data-bind="text:'Delete', click: $root.account.deleteAccount"></a>
                                    </li>
                                    <li>
                                        <a href="#" data-bind="text:'Edit Security Groups', click: $root.securityGroup.setForAccount"></a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

        <!-- 
            ======================================================================
            A C C O U N T   F O R M
            ======================================================================
        -->
        <div id="accounts-form-container" title="New Provider Account Details" class="stackd-form form-small">
            <form id="account-form" role="form" class="form-horizontal">
                <div class="modal-body large-modal-body">
                    <div class="form-group">
                        <label for="account_title" class="col-sm-4 control-label">Title</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="account_title" placeholder="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="account_description" class="col-sm-4 control-label">Description</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="account_description" placeholder="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="account_id" class="col-sm-4 control-label">Account ID</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="account_id" placeholder="Log into your account to obtain the id">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="access_key_id" class="col-sm-4 control-label">AWS Access Key</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="access_key_id" placeholder="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="secret_access_key" class="col-sm-4 control-label">AWS Secret Key</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="secret_access_key" placeholder="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="keypair" class="col-sm-4 control-label">AWS Keypair Name</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="keypair" placeholder="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="default_availability_zone" class="col-sm-4 control-label">Default Zone</label>
                        <div class="col-sm-8">
                            <select id="default_availability_zone" 
                                data-bind="options: stores.Zones, 
                                           optionsText: 'title', 
                                           optionsValue: 'id', 
                                           optionsCaption: 'Choose default zone...'" 
                                data-container="body"
                                class="stretch-full"></select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="route53_domain" class="col-sm-4 control-label">Route 53 Domain</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="route53_domain" placeholder="e.g. dev.synthesyscloud.com">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="private_key_file" class="col-sm-4 control-label">Private Key File</label>
                        <div class="col-sm-8">
                            <textarea class="form-control" id="private_key_file" rows="6" placeholder="Enter in the private key that will be used to set up instances for this account"></textarea>
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn" data-bind="click: $root.account.closeAccountForm">Close</button>
                    <button class="btn btn-primary" data-bind="click: $root.account.addAccount">Save</button>
                </div>
            </form>
        </div>
    </div>


    <!-- 
        ======================================================================
        P R O F I L E   L I S T
        ======================================================================
    -->
    <div id="profile-binding-target" class="hide" data-bind='visible: currentSection() === "Accounts" && stores.AccountProfiles().length > 0'>
        <div class="view">
            <div class="row bottom-separation">
                <div class="col-xs-4 col-sm-4 col-md-4 medium-heading">Account Profiles</div>
                <div class="col-xs-4 col-sm-4 col-md-4 col-md-offset-4 col-sm-offset-4 col-xs-offset-4">
                    <div class="btn-group pull-right" data-bind="visible: $root.isSuperUser">
                        <button class="btn btn-primary" data-bind="click: $root.profile.showProfileForm">New Profile</button>
                    </div>
                </div>
            </div>

            <table id="profiles" class="table table-bordered">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Description</th>
                        <th>ID</th>
                        <th style="width:5%"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.AccountProfiles">
                    <tr>
                        <td data-bind="text: title"></td>
                        <td data-bind="text: description"></td>
                        <td data-bind="text: typeof image_id === 'object' ? 'n/a' : image_id"></td>
                        <td>
                            <div class="btn-group" data-bind="visible: $root.isSuperUser">
                                <a class="btn btn-info dropdown-toggle btn-sm" data-toggle="dropdown" href="#">
                                    Action <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="#" data-bind="text:'Delete', click: $root.profile.deleteProfile"></a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

        <!-- 
            ======================================================================
            P R O F I L E   F O R M
            ======================================================================
        -->
        <div id="profile-form-container" title="New Profile Details" class="stackd-form form-small">
            <form id="profile-form" role="form" class="form-horizontal">
                <div class="modal-body large-modal-body">
                    <div class="form-group">
                        <label for="profile_title" class="col-sm-4 control-label">Title</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="profile_title" placeholder="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="profile_description" class="col-sm-4 control-label">Description</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="profile_description" placeholder="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="image_id" class="col-sm-4 control-label">AMI</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="image_id" placeholder="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="ssh_user" class="col-sm-4 control-label">SSH User</label>
                        <div class="col-sm-8">
                            <input type="text" class="form-control" id="ssh_user" placeholder="">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="default_instance_size" class="col-sm-4 control-label">Default Instance Size</label>
                        <div class="col-sm-8">
                            <select id="default_instance_size" 
                                data-bind="options: stores.InstanceSizes, 
                                           optionsText: 'title', 
                                           optionsValue: 'id', 
                                           optionsCaption: 'Choose...'" 
                                data-size="8"
                                data-container="body"
                                class="stretch-full"></select>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <button class="btn" data-bind="click: $root.profile.closeProfileForm">Close</button>
                    <button class="btn btn-primary" data-bind="click: $root.profile.addProfile">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 
        ======================================================================
        S E C U R I T Y   G R O U P   L I S T
        ======================================================================
    -->
    <div id="security-group-container" class="hide" data-bind='visible: currentSection() === "Security"'>
        <div class="view">
            <div class="btn-group pull-right bottom-separation">
                <a class="btn btn-primary dropdown-toggle" data-toggle="dropdown" href="#">
                    New Security Group
                    <span class="caret"></span>
                </a>
                <ul class="dropdown-menu" data-bind="foreach: stores.Accounts">
                    <li>
                        <a href="#" data-bind="text: title, click: $root.securityGroup.showSecurityGroupForm"></a>
                    </li>
                </ul>
            </div>

            <div class="pull-left">

                <div class="pagination" data-bind="visible: $root.securityGroup.showPagination">
                    <ul>
                        <li data-bind="css: { disabled: $root.securityGroup.previousLink() === null }">
                            <a href="#" 
                                data-bind="click: function () { $root.securityGroup.paginate($root.securityGroup.previousLink()); } ">Previous</a>
                        </li>
                        <li data-bind="css: { disabled: $root.securityGroup.nextLink() === null }">
                            <a href="#" data-bind="click: function () { $root.securityGroup.paginate($root.securityGroup.nextLink()); }">Next</a>
                        </li>
                    </ul>
                </div>
            </div>


            <table id="security_group_list" class="table table-bordered">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Description</th>
                        <th>Account</th>
                        <th data-bind="visible: stackdio.settings.superuser === true">Owner</th>
                        <th style="width:5%"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.SecurityGroups">
                    <tr>
                        <td data-bind="text: name"></td>
                        <td data-bind="text: description"></td>
                        <td data-bind="text: account.title"></td>
                        <td data-bind="text: owner, visible: stackdio.settings.superuser === true"></td>
                        <td>
                            <div class="btn-group">
                                <a class="btn btn-info btn-small dropdown-toggle" data-toggle="dropdown" href="#">
                                    Action <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="#" data-bind="text:'Delete', click: $root.securityGroup.deleteSecurityGroup"></a>
                                    </li>
                                    <li>
                                        <a href="#" data-bind="text:'Define Rules', click: $root.securityGroup.editGroupRules"></a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

        <!-- 
            ======================================================================
            S E C U R I T Y   G R O U P   F O R M
            ======================================================================
        -->
        <div id="securitygroup-form-container" title="New Security Group" class="stackd-form form-small">
            <form id="securitygroup-form" role="form" class="form-horizontal">
                <div class="modal-body">

                    <div class="form-group">
                        <label for="securitygroup_name" class="col-sm-3 control-label">Title</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" id="securitygroup_name" placeholder=""
                                   data-bind="event: { keypress: securityGroup.captureNewGroup }">
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn" data-bind="click: $root.securityGroup.closeSecurityGroupForm">Close</button>
                    <button class="btn btn-primary" data-bind="click: function (data, event) { 
                                        securityGroup.addSecurityGroup($('#securitygroup_name').val(), event); 
                                    }">Save</button>
                </div>
            </form>
        </div>

        <!-- 
            ======================================================================
            S E C U R I T Y   G R O U P   R U L E S   L I S T   D I A L O G
            ======================================================================
        -->
        <div id="securitygroup-rules-form-container" title="Security Group Rules" class="stackd-form">
            <div class="modal-body">
                <table id="security_group_rules_list" class="table table-striped data-grid">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>From</th>
                            <th>To</th>
                            <th>Protocol</th>
                            <th style="width:5%"></th>
                        </tr>
                    </thead>
                    <tbody data-bind="foreach: stores.SecurityGroupRules">
                        <tr>
                            <td data-bind="text: (rule.split(':').length === 1) ? rule : rule.split(':')[1]"></td>
                            <td data-bind="text: from_port"></td>
                            <td data-bind="text: to_port"></td>
                            <td data-bind="text: protocol"></td>
                            <td>
                                <button type="button" 
                                        class="btn-small btn-danger iconic-trash-stroke"
                                        data-bind="click: $root.securityGroup.deleteGroupRule"
                                ></button>
                            </td>
                        </tr>     
                    </tbody>
                </table>
            </div>

            <div class="modal-footer">
                <button class="btn" data-bind="click: $root.securityGroup.closeRulesForm">Close</button>
                <button class="btn btn-success iconic-plus" data-bind="click: function () { 
                                    $('#new-rule-dialog').dialog('open');
                                }"> Add</button>
            </div>
        </div>

        <!-- 
            ======================================================================
            N E W   S E C U R I T Y   G R O U P   R U L E   D I A L O G
            ======================================================================
        -->
        <div id="new-rule-dialog" title="New Access Rule" class="stackd-form">
            <form id="group-rule-form" class="form-horizontal">
                <div class="modal-body">

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="rule_protocol">Protocol</label>
                        <div class="controls" style="margin-left: 160px">
                            <select id="rule_protocol" 
                                    data-bind="options: ['tcp','udp','icmp']",
                                    data-container="body"
                                    class="input-xlarge"></select> 
                        </div>
                    </div>


                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="rule_from_port">From port</label>
                        <div class="controls" style="margin-left: 160px">
                            <input id="rule_from_port" type="text" class="input-xlarge" placeholder="22">
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="rule_to_port">To port</label>
                        <div class="controls" style="margin-left: 160px">
                            <input id="rule_to_port" type="text" class="input-xlarge" placeholder="22">
                        </div>
                    </div>

                    <hr/>

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="rule_ip_address">IP address</label>
                        <div class="controls" style="margin-left: 160px">
                            <input id="rule_ip_address" type="text" class="input-xlarge" placeholder="0.0.0.0/32">
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="none"></label>
                        <div class="controls" style="margin-left: 160px">
                            or
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" style="width: 140px;" for="rule_group">Group</label>
                        <div class="controls" style="margin-left: 160px">
                            <input id="rule_group" type="text" class="input-xlarge" placeholder="another group name">
                        </div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn" data-bind="click: function () { $('#new-rule-dialog').dialog('close') }">Cancel</button>
                    <button class="btn btn-primary" data-bind="click: securityGroup.addRule"> Save</button>
                </div>
            </form>
        </div>

        <!-- 
            ======================================================================
            D E F A U L T   S E C U R I T Y   G R O U P   F O R M
            ======================================================================
        -->
        <div id="default-securitygroup-form-container" title="Default Security Groups" class="stackd-form form-small">
            <form id="default-securitygroup-form" class="form-horizontal" role="form">
                <div class="modal-body large-modal-body">

                    <div class="form-group">
                        <div class="lead">Option 1. Use an existing group</div>
                        If you previously imported AWS groups, or created your own through stackd.io, you can select one of 
                        those groups that are listed here.
                    </div>

                    <div class="form-group">
                        <label for="stackdio_security_group" class="col-sm-3 control-label">Your stackd.io groups</label>
                        <div class="col-sm-7">
                            <select id="stackdio_security_group" 
                                    class="form-control"
                                    data-bind="options: stores.AccountSecurityGroups, 
                                               optionsValue: 'id', 
                                               optionsText: 'title'",
                                    data-size="12"
                                    data-container="body"></select> 
                        </div>
                        <div class="col-sm-2">
                            <button class="btn btn-success glyphicon glyphicon-plus" 
                                data-bind="click: function (data, event) { 
                                    securityGroup.addDefaultSecurityGroup($('#stackdio_security_group option:selected').text(), event); 
                                }"> Add</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="lead">Option 2. Create new group</div>
                        If you would like to create a new security group that does not already exist in stackd.io, 
                        simply type in the name for the group here and it will created. If there are existing AWS
                        groups that match what you are entering, you will see suggestions.
                    </div>

                    <div class="form-group">
                        <label for="new_securitygroup_name" class="col-sm-3 control-label">Create new group</label>
                        <div class="col-sm-7">
                            <input id="new_securitygroup_name" 
                                   type="text"
                                   class="form-control typeahead"
                                   data-bind="event: { keypress: securityGroup.capture }"> 

                        </div>
                        <div class="col-sm-2">
                            <button class="btn btn-success glyphicon glyphicon-plus" 
                                    data-bind="click: function (data, event) { 
                                        securityGroup.addDefaultSecurityGroup(document.getElementById('new_securitygroup_name').value, event); 
                                    }"> Add</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="lead">Assigned Default Groups</div>
                        <div>To remove any default security groups assigned to this account, click on the 'x' in the label below.</div>
                        <div style="margin: 10px 0 0 0;" id="default_group_list"></div>
                    </div>

                </div>

                <div class="modal-footer">
                    <button class="btn" data-bind="click: $('#default-securitygroup-form-container').dialog('close')">Cancel</button>
                    <button class="btn btn-primary iconic-check" data-bind="click: $('#default-securitygroup-form-container').dialog('close')"> Done</button>
                </div>
            </form>
        </div>
    </div>


    <!-- 
        ======================================================================
        F O R M U L A   L I S T
        ======================================================================
    -->
    <div id="formula-binding-target" class="hide" data-bind='visible: currentSection() === "Formula"'>
        <div class="view">
            <div class="btn-group pull-right bottom-separation">
                <button class="btn btn-primary" data-bind="click: $root.formula.showFormulaForm">Import Formula</button>
            </div>

            <table id="formulae" class="table table-bordered ">
                <thead>
                    <tr>
                        <th style="width:20%">Title</th>
                        <th>Description</th>
                        <th>Status</th>
                        <th style="width:5%"></th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: stores.Formulae">
                    <tr data-bind="attr: { class: (public) ? 'success' : '' }">
                        <td>
                            <a href='#' 
                               data-bind="bootstrapPopover: {
                                            content: $root.formula.popoverBuilder($data),
                                            title: 'Formula Components'
                                          },
                                          text: title"></a>
                        </td>
                        <td data-bind="text: description"></td>
                        <td data-bind="text: status_detail"></td>
                        <td>
                            <div class="btn-group" data-bind="visible: $root.isSuperUser">
                                <a class="btn btn-info dropdown-toggle" data-toggle="dropdown" href="#">
                                    Action <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu">
                                    <li>
                                        <a href="#" data-bind="text: (!public) ? 'Make Public' : 'Make Private', click: $root.formula.share"></a>
                                    </li>
                                    <li>
                                        <a href="#" data-bind="text:'Delete', click: $root.formula.delete"></a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>     
                </tbody>
            </table>
        </div>

        <!-- 
            ======================================================================
            F O R M U L A   F O R M
            ======================================================================
        -->
        <div id="formula-form-container" title="Import Formula" class="stackd-form form-small">
            <form id="formula-form">
                <div class="modal-body large-modal-body">

                    <div class="form-group">
                            <input type="text" class="form-control" id="formula_url" placeholder="Enter repository URL...">
                    </div>

                <div class="modal-footer" style="margin-top: 40px;">
                    <button class="btn btn-danger" data-bind="click: $root.formula.closeFormulaForm">Cancel</button>
                    <button class="btn btn-primary" data-bind="click: $root.formula.importFormula">Import</button>
                </div>
            </form>
        </div>
    </div>

    <script data-main="/static/stackdio/require-config" src="/static/stackdio/require.js"></script>
    <script>
    window.stackdio_user = {};
    window.stackdio_user.su = "{{ user.is_superuser }}";
    </script>


<!--
    <script src="/static/js/require.js"></script>
        <script>
            /*
             * 
             *  WHEN READY TO TRY A PRODUCTION BUILD, FOLLOW THESE INSTRUCTIONS
             *
             *      1. Ensure you have node.js installed on your system.
             *      2. npm install -g requirejs
             *      3. cd /{stackdio_root_dir}/core/static
             *      4. node r.js -o build.js
             *      5. Then uncomment this block of code, and comments out the <script> tag above.
             *
             */
            require.config({
                paths: {
                    //Comment out this line to go back to loading
                    //the non-optimized main.js source file.
                    "app": "/static/stackdio-built"
                }
            });
            require(["app"]);
        </script>
-->

</body>
</html>
